# PDF版マニュアル生成手順

## 方法1: ブラウザの印刷機能を使用（推奨）

### 前準備
HTMLファイルには改ページ制御が組み込まれており、各セクションが自動的にA4ページに収まるように設計されています。

### 手順

1. **MANUAL.htmlをブラウザで開く**
   - `MANUAL.html`をダブルクリックしてMicrosoft EdgeまたはGoogle Chromeで開く

2. **印刷ダイアログを開く**
   - キーボードで`Ctrl + P`を押す
   - または、ブラウザのメニューから「印刷」を選択

3. **PDF設定を行う（重要）**
   - **送信先**: 「PDFに保存」を選択
   - **ページ設定**:
     - 用紙サイズ: **A4**
     - 余白: **標準**または**既定**
     - 向き: **縦**
     - 倍率: **100%**（縮小しない）
   - **オプション**:
     - 背景のグラフィック: **ON**（チェックを入れる）※重要
     - ヘッダーとフッター: **OFF**（チェックを外す）
     - ページ範囲: **すべて**

4. **印刷プレビューで確認**
   - 右側のプレビュー画面で改ページ位置を確認
   - 画像や表が途中で切れていないか確認
   - 赤背景のプライバシー注釈が表示されているか確認

5. **保存**
   - 「保存」ボタンをクリック
   - ファイル名を`調剤券請求書作成ツール_操作マニュアル.pdf`にして保存

### Microsoft Edgeでの具体的な手順

```
1. MANUAL.htmlを開く
2. Ctrl + P を押す
3. 送信先で「PDFに保存」を選択
4. 「その他の設定」をクリック
5. 以下を設定:
   - 用紙サイズ: A4
   - ページ: すべて
   - 1ページあたりのページ数: 1
   - 余白: 既定
   - 倍率: 既定（100%）
   - 背景のグラフィック: ✅ ON（必須）
   - ヘッダーとフッター: ☐ OFF
6. プレビュー画面で改ページを確認
7. 「保存」をクリック
8. ファイル名を「調剤券請求書作成ツール_操作マニュアル.pdf」にして保存
```

### Google Chromeでの具体的な手順

```
1. MANUAL.htmlを開く
2. Ctrl + P を押す
3. 送信先で「PDFに保存」を選択
4. 「詳細設定」をクリック
5. 以下を設定:
   - 用紙サイズ: A4
   - ページ: すべて
   - 余白: 標準
   - 倍率: 100%（重要）
   - 背景のグラフィック: ✅ ON（必須）
   - ヘッダーとフッター: ☐ OFF
6. プレビュー画面で改ページを確認
7. 「保存」をクリック
8. ファイル名を「調剤券請求書作成ツール_操作マニュアル.pdf」にして保存
```

---

## 方法2: PowerShellスクリプトを使用（自動化）

### 前提条件
- Google Chromeがインストールされていること
- ChromeのHeadlessモードを使用

### PowerShellスクリプト

以下の内容を`generate-pdf.ps1`として保存:

```powershell
# PDF生成スクリプト
$chromePath = "C:\Program Files\Google\Chrome\Application\chrome.exe"
$htmlPath = Join-Path $PSScriptRoot "MANUAL.html"
$pdfPath = Join-Path $PSScriptRoot "MANUAL.pdf"

# 既存のPDFを削除
if (Test-Path $pdfPath) {
    Remove-Item $pdfPath -Force
}

# ChromeでPDF生成
& $chromePath --headless --disable-gpu --print-to-pdf="$pdfPath" --print-to-pdf-no-header "$htmlPath"

Write-Host "✅ PDFを生成しました: $pdfPath"
```

### 実行方法

```powershell
powershell -ExecutionPolicy Bypass -File generate-pdf.ps1
```

---

## 方法3: オンラインツールを使用

### 推奨サービス
以下のオンラインサービスでHTMLをPDFに変換できます:

1. **PDF24 Tools** (https://tools.pdf24.org/ja/)
   - 無料、広告なし
   - プライバシー保護

2. **Convertio** (https://convertio.co/ja/html-pdf/)
   - 無料版あり
   - ファイルサイズ制限あり

### 手順
1. サービスにアクセス
2. `MANUAL.html`をアップロード
3. 「PDFに変換」をクリック
4. 変換後のPDFをダウンロード

---

## PDF確認ポイント

生成されたPDFファイルが以下の要件を満たしているか確認してください:

### 必須チェック項目
- [ ] 用紙サイズがA4である
- [ ] 背景色（青色の手順ボックス、赤色のプライバシー注釈）が表示されている
- [ ] 各セクション（h1見出し）が新しいページから始まっている
- [ ] 表紙が独立したページになっている
- [ ] 目次が独立したページになっている
- [ ] 画像が途中で切れていない（改ページで分断されていない）
- [ ] 表（table）が途中で切れていない

### 品質チェック項目
- [ ] 画像が鮮明に表示されている（ぼやけていない）
- [ ] テキストが読みやすいサイズである
- [ ] 余白が適切である（上下20mm、左右15mm程度）
- [ ] 赤背景のプライバシー注釈が図5と図6に表示されている
- [ ] ヘッダー・フッターが表示されていない

---

## トラブルシューティング

### 画像が表示されない
**原因**: `photo/`フォルダが見つからない
**解決策**: `photo/`フォルダが`MANUAL.html`と同じディレクトリにあることを確認

### 背景色が表示されない（白黒になる）
**原因**: 「背景のグラフィック」がOFFになっている
**解決策**: 印刷設定で「背景のグラフィック」を必ずONにする

### 改ページ位置がおかしい
**原因**: ブラウザの倍率が100%でない
**解決策**:
1. ブラウザの表示倍率を100%に設定（Ctrl + 0）
2. 印刷設定の「倍率」を100%に設定

### 画像や表が途中で切れる
**原因**: CSSの改ページ制御が効いていない
**解決策**:
1. 最新版のEdgeまたはChromeを使用
2. 印刷プレビューで確認し、問題があれば余白を調整

### ファイルサイズが大きすぎる
**原因**: 画像が高解像度
**解決策**:
1. 印刷品質を「標準」に設定
2. それでも大きい場合は、オンラインPDF圧縮ツールを使用

### 文字が小さすぎて読めない
**原因**: 印刷設定の倍率が100%未満
**解決策**: 印刷設定の「倍率」を100%に設定（縮小しない）

---

**推奨方法**: 方法1（ブラウザの印刷機能）が最も簡単で確実です。
**所要時間**: 約2分
**ファイルサイズ**: 約1-2MB（画像込み）
